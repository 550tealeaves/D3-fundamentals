<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <title>Pie and Doughnut</title>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <style type="text/css">
        .labels {
            font-size: 12px;
            font-weight: bold;
            font-family: sans-serif;
            fill: aliceblue;
        }
    </style>
</head>

<body>
    <script type="text/javascript">

        //Data
        
        //problem is that it's showing each individual pokemon & each true/false legendary status instead of grouping them
        //in tableau, it looks like I did a individual count for each, but not sure how to replicate that in d3


        d3.csv("pokemon_g1tog3.csv").then(data => {
            console.log("data", data)

            //format data
            data.forEach(d => {
                d.legendary = d.legendary;
                d.name = d.name;
                d.generation = +d.generation;
            });

            //DECLARE CONSTANTS & ORDINAL COLOR SCALE
            const width = 600;
            const height = 600;
            //const myColor = d3.scaleOrdinal(d3.schemeSpectral[5]);
            const myColor = d3.scaleOrdinal(["royalblue", "pink"]);

            //RADIUS INFORMATION
            const outerRadius = width / 2;
            //const outerRadius = 200;
            const innerRadius = 0;
            //const innerRadius = 150; //to make a doughnut!


            //TO CREATE A PIE, USE D3.ARC() & PIE GENERATOR

            //D3.ARC()
            //d3.arc() CREATES WEDGES 
            const arc = d3.arc()
                .innerRadius(innerRadius)//required 
                .outerRadius(outerRadius) //required
                //.cornerRadius(10);
                .cornerRadius(177); //makes it more interesting looking

            //PIE GENERATOR
            //EDIT THE padAngle, startAngle & endAngle TO MAKE A MORE INTERESTING LOOKING CHART
            const pie = d3.pie().value(d => d.generation)
                //.padAngle(.04); //adds space b/w arcs - apply here so you don't add bias
                //.startAngle(-0.5 * Math.PI) //have to compute radians - changes shape [1 radian = (180/pi), 2pi = 90]
                //.endAngle(0.5 * Math.PI); //must include start/end angle 
                //.startAngle(0 * Math.PI)
                //.endAngle(1 * Math.PI);
                //.startAngle(0 * Math.PI)
                //.endAngle(0.5 * Math.PI);
                //.startAngle(0.5 * Math.PI)
                //.endAngle(2 * Math.PI);
            // .startAngle(-0.5 * Math.PI)
            // .endAngle(0 * Math.PI);

            //SVG
            const svg = d3.select("body")
                .append("svg")
                .attr("width", width)
                .attr("height", height);

            //GROUPS TO BUILD CHART
            const groups = svg.selectAll("g.arc")
                .data(pie(data))//give data to our pie generator - could also have created a separate constant instead
                .enter()
                .append("g")
                .attr("class", "arc")
                .attr("transform", "translate(" + outerRadius + "," + outerRadius + ")");//arcs transform translate 
            console.log("pie data", pie(data));

            groups.append("path")
                .attr("fill", (d, i) => myColor(i)) //gave it the index (i)
                .attr("d", arc); //d of our path 

            //LABELS
            groups.append("text")
                .attr("transform", d => "translate(" + arc.centroid(d) + ")") //arc.centroid figures out the math
                .attr("text-anchor", "middle")
                .attr("class", "labels")
                .text(d => d.data.legendary);//in console look at "pie data" to see structure (data > part)

            /*Note: if you happen to like round / doughnut charts 
              another option is to think into how you might make a radial
              bar chart, another common round chart.*/
        });

    </script>
</body>

</html>