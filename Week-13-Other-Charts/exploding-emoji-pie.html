<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Exploding Emoji Pie Chart</title>
  <script src="https://d3js.org/d3.v7.min.js"></script>
  <style>
    body {
      font-family: sans-serif;
      background: #f7f7f7;
      display: flex;
      justify-content: center;
      padding-top: 50px;
    }
    text {
      font-size: 32px;
      pointer-events: none;
    }
  </style>
</head>
<body>

<script>
// Data
const data = [
  { animal: "Dogs", value: 20, emoji: "ðŸ¶" },
  { animal: "Cats", value: 50, emoji: "ðŸ±" },
  { animal: "Birds", value: 10, emoji: "ðŸ¦" },
  { animal: "Fish", value: 5, emoji: "ðŸŸ" },
  { animal: "Hedgehog", value: 15, emoji: "ðŸ¦”" }
];

// Dimensions
const width = 800;
const height = 500;
const radius = Math.min(width, height) / 2;

// Color scale (optional, can be used for slice background if you want)
const color = d3.scaleOrdinal()
  .domain(data.map(d => d.animal))
  .range(["#F2755E", "#E65EF2", "#16DE2A", "#3BF7E7", "#F7F73B"]);

// SVG
const svg = d3.select("body")
  .append("svg")
    .attr("width", width)
    .attr("height", height)
  .append("g")
    .attr("transform", `translate(${width/2}, ${height/2})`);

// Pie generator
const pie = d3.pie()
  .value(d => d.value)
  .sort(null);

// Arc generator
const arc = d3.arc()
  .innerRadius(15) // increase # - more it turns into donut
  .outerRadius(radius);

// Explode distance
const explode = 40; //larger # = more the pieces move away

// Draw slices
const slices = svg.selectAll("path")
  .data(pie(data))
  .join("path")
    .attr("fill", d => color(d.data.animal))
    .attr("stroke", "#fff")
    .attr("stroke-width", 2)
    .attr("d", arc)
    .each(function(d) { this._current = d; }) // store initial state

// Animate slices slightly outward (explode effect)
slices.transition()
  .duration(1500)
  .attrTween("transform", function(d) {
    const midAngle = (d.startAngle + d.endAngle) / 2;
    const x = Math.cos(midAngle) * explode;
    const y = Math.sin(midAngle) * explode;
    return function(t) {
      return `translate(${x*t}, ${y*t})`;
    };
  });

// Place emojis at slice centroids
svg.selectAll("text")
  .data(pie(data))
  .join("text")
    .text(d => d.data.emoji)
    .attr("font-size", "32px")
    .attr("text-anchor", "middle")
    .attr("dy", "0.35em")
    .attr("transform", d => {
      const centroid = arc.centroid(d);
      const midAngle = (d.startAngle + d.endAngle) / 2;
      const x = centroid[0] + Math.cos(midAngle) * explode;
      const y = centroid[1] + Math.sin(midAngle) * explode;
      return `translate(${x}, ${y})`;
    })
    .attr("opacity", 0)
  .transition()
    .duration(2000)
    .attr("opacity", 1);

</script>

</body>
</html>
